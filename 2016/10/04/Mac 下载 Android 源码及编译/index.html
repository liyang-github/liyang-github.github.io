<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Mac 下载 Android 源码及编译 | 以梦为马 不负韶华</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Jdk 版本要求The master branch of Android in AOSP: Ubuntu - OpenJDK 8, Mac OS - jdk 8u45 or newer
Android 5.x (Lollipop) - Android 6.0 (Marshmallow): Ubuntu - OpenJDK 7, Mac OS - jdk-7u71-macosx-x64.dmg
An">
<meta property="og:type" content="article">
<meta property="og:title" content="Mac 下载 Android 源码及编译">
<meta property="og:url" content="https://liyang-github.github.io/2016/10/04/Mac 下载 Android 源码及编译/index.html">
<meta property="og:site_name" content="以梦为马 不负韶华">
<meta property="og:description" content="Jdk 版本要求The master branch of Android in AOSP: Ubuntu - OpenJDK 8, Mac OS - jdk 8u45 or newer
Android 5.x (Lollipop) - Android 6.0 (Marshmallow): Ubuntu - OpenJDK 7, Mac OS - jdk-7u71-macosx-x64.dmg
An">
<meta property="og:updated_time" content="2016-10-11T16:01:03.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Mac 下载 Android 源码及编译">
<meta name="twitter:description" content="Jdk 版本要求The master branch of Android in AOSP: Ubuntu - OpenJDK 8, Mac OS - jdk 8u45 or newer
Android 5.x (Lollipop) - Android 6.0 (Marshmallow): Ubuntu - OpenJDK 7, Mac OS - jdk-7u71-macosx-x64.dmg
An">
  
    <link rel="alternative" href="/atom.xml" title="以梦为马 不负韶华" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.png">
  
  
      <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          rootUrl: '/',
          fancybox: true,
          animate: true,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/head.jpg" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/" title="Hi Mate">以梦为马</a></h1>
        </hgroup>

        
        <p class="header-subtitle">交流 QQ 群（418766153）</p>
        
        
            <form>
                <input type="text" class="st-default-search-input search" id="search" placeholder=" Search...">
            </form>
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">首页</a></li>
                        
                            <li><a href="/archives">记录</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl mail" target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=Fnp-b3d4cScmJy5WcHlue3d-ejh1eXs&from=url&k=3NJWyYEH" title="mail">mail</a>
                            
                                <a class="fl github" target="_blank" href="https://github.com/liyang-github" title="github">github</a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/Android/" style="font-size: 10px;">Android</a>
                    </div>
                </section>
                
                
                

                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="Me">以梦为马</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/head.jpg" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="Me">以梦为马</a></h1>
            </hgroup>
            
            <p class="header-subtitle">交流 QQ 群（418766153）</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">首页</a></li>
                
                    <li><a href="/archives">记录</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="mail" target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=Fnp-b3d4cScmJy5WcHlue3d-ejh1eXs&from=url&k=3NJWyYEH" title="mail">mail</a>
                    
                        <a class="github" target="_blank" href="https://github.com/liyang-github" title="github">github</a>
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap"><article id="post-Mac 下载 Android 源码及编译" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/10/04/Mac 下载 Android 源码及编译/" class="article-date">
      <time datetime="2016-10-04T12:38:56.000Z" itemprop="datePublished">2016-10-04</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Mac 下载 Android 源码及编译
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        

        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="Jdk-版本要求"><a href="#Jdk-版本要求" class="headerlink" title="Jdk 版本要求"></a>Jdk 版本要求</h1><pre><code>The master branch of Android in AOSP: Ubuntu - OpenJDK 8, Mac OS - jdk 8u45 or newer
Android 5.x (Lollipop) - Android 6.0 (Marshmallow): Ubuntu - OpenJDK 7, Mac OS - jdk-7u71-macosx-x64.dmg
Android 2.3.x (Gingerbread) - Android 4.4.x (KitKat): Ubuntu - Java JDK 6, Mac OS - Java JDK 6
Android 1.5 (Cupcake) - Android 2.2.x (Froyo): Ubuntu - Java JDK 5
</code></pre><a id="more"></a>
<h1 id="Mac-OS-build-environment"><a href="#Mac-OS-build-environment" class="headerlink" title="Mac OS build environment"></a>Mac OS build environment</h1><h2 id="创建区分大小写的镜像（Creating-a-case-sensitive-disk-image）"><a href="#创建区分大小写的镜像（Creating-a-case-sensitive-disk-image）" class="headerlink" title="创建区分大小写的镜像（Creating a case-sensitive disk image）"></a>创建区分大小写的镜像（Creating a case-sensitive disk image）</h2><h3 id="方法一，使用命令创建"><a href="#方法一，使用命令创建" class="headerlink" title="方法一，使用命令创建"></a>方法一，使用命令创建</h3><p>You can create a case-sensitive filesystem within your existing Mac OS environment using a disk image. To create the image, launch Disk Utility and select “New Image”. A size of 25GB is the minimum to complete the build; larger numbers are more future-proof. Using sparse images saves space while allowing to grow later as the need arises. Be sure to select “case sensitive, journaled” as the volume format.</p>
<p>You can also create it from a shell with the following command:</p>
<pre><code># hdiutil create -type SPARSE -fs &apos;Case-sensitive Journaled HFS+&apos; -size 40g ~/android.dmg
</code></pre><p>This will create a .dmg (or possibly a .dmg.sparseimage) file which, once mounted, acts as a drive with the required formatting for Android development.</p>
<p>If you need a larger volume later, you can also resize the sparse image with the following command:</p>
<pre><code># hdiutil resize -size &lt;new-size-you-want&gt;g ~/android.dmg.sparseimage
</code></pre><p>For a disk image named android.dmg stored in your home directory, you can add helper functions to your ~/.bash_profile:</p>
<pre><code>To mount the image when you execute mountAndroid:

# mount the android file image
function mountAndroid { hdiutil attach ~/android.dmg -mountpoint /Volumes/android; }

Note: If your system created a .dmg.sparseimage file, replace ~/android.dmg with ~/android.dmg.sparseimage.

To unmount it when you execute umountAndroid:

# unmount the android file image
function umountAndroid() { hdiutil detach /Volumes/android; }
</code></pre><p>Once you’ve mounted the android volume, you’ll do all your work there. You can eject it (unmount it) just like you would with an external drive.</p>
<h3 id="方法二，使用磁盘工具创建"><a href="#方法二，使用磁盘工具创建" class="headerlink" title="方法二，使用磁盘工具创建"></a>方法二，使用磁盘工具创建</h3><ul>
<li>在 Filder 中打开 磁盘工具</li>
<li>在磁盘工具中选择 分区</li>
<li>分一个 200G 的 区分大小写的镜像</li>
</ul>
<h2 id="安装-JDK-和-SDK-下载安装包安装即可，略"><a href="#安装-JDK-和-SDK-下载安装包安装即可，略" class="headerlink" title="安装 JDK 和 SDK (下载安装包安装即可，略)"></a>安装 JDK 和 SDK (下载安装包安装即可，略)</h2><ul>
<li>Android Studio（直接可以安装 SDK） 下载地址 <a href="http://www.android-studio.org/" target="_blank" rel="external">http://www.android-studio.org/</a></li>
<li>JDK 下载地址 <a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk-netbeans-jsp-142931.html?ssSourceSiteId=otncn" target="_blank" rel="external">http://www.oracle.com/technetwork/java/javase/downloads/jdk-netbeans-jsp-142931.html?ssSourceSiteId=otncn</a></li>
</ul>
<h2 id="Installing-required-packages"><a href="#Installing-required-packages" class="headerlink" title="Installing required packages"></a>Installing required packages</h2><h3 id="Install-MacPorts-from-macports-org-直接下载MacPorts-xxx-pkg文件安装即可-xxx为版本号"><a href="#Install-MacPorts-from-macports-org-直接下载MacPorts-xxx-pkg文件安装即可-xxx为版本号" class="headerlink" title="Install MacPorts from macports.org(直接下载MacPorts_xxx.pkg文件安装即可(xxx为版本号))"></a>Install MacPorts from macports.org(直接下载MacPorts_xxx.pkg文件安装即可(xxx为版本号))</h3><pre><code>Note: Make sure that /opt/local/bin appears in your path before /usr/bin。可以通过$ echo $PATH命令查看。如果不是，在~/.bash_profile文件中添加下面代码，添加完毕后直接执行$ source ~/.bash_profile命令。

export PATH=/opt/local/bin:$PATH    

我的情况是MacPorts_xxx.pkg安装完毕后，其自动在~/.bash_profile文件里添加了export PATH=&quot;/opt/local/bin:/opt/local/sbin:$PATH&quot;
</code></pre><h3 id="Get-make-git-and-GPG-packages-from-MacPorts"><a href="#Get-make-git-and-GPG-packages-from-MacPorts" class="headerlink" title="Get make, git, and GPG packages from MacPorts:"></a>Get make, git, and GPG packages from MacPorts:</h3><pre><code>$ POSIXLY_CORRECT=1 sudo port install gmake libsdl git gnupg

If using Mac OS X v10.4, also install bison:

$ POSIXLY_CORRECT=1 sudo port install bison

报错：

Error: Port gmake not found  

执行$ sudo port -d sync即可。
若执行上述命令继续报如下错误：

receiving file list ... rsync: read error: Operation timed out (60)
Error: Synchronization of the local ports tree failed doing rsync
port sync failed: Synchronization of 1 source(s) failed  

解决办法：
修改 /opt/local/etc/macports/sources.conf，将原来最后一行修改成如下，然后执行$ sudo prot -v selfupdate即可。

#rsync://rsync.macports.org/release/tarballs/ports.tar [default]
https://distfiles.macports.org/ports.tar.gz [default]
</code></pre><h2 id="下载-repo-工具"><a href="#下载-repo-工具" class="headerlink" title="下载 repo 工具"></a>下载 repo 工具</h2><pre><code>mkdir ~/bin
PATH=~/bin:$PATH
curl https://storage.googleapis.com/git-repo-downloads/repo &gt; ~/bin/repo
chmod a+x ~/bin/repo
</code></pre><blockquote>
<p>注：这样设置的环境变量 PATH 是临时，这样正好。bin 文件可以建在源码文件夹的同级目录下</p>
</blockquote>
<h2 id="初始化repo"><a href="#初始化repo" class="headerlink" title="初始化repo"></a>初始化repo</h2><pre><code>Create an empty directory to hold your working files. If you&apos;re using MacOS, this has to be on a case-sensitive filesystem. Give it any name you like:

$ mkdir WORKING_DIRECTORY
$ cd WORKING_DIRECTORY

Configure git with your real name and email address. To use the Gerrit code-review tool, you will need an email address that is connected with a registered Google account. Make sure this is a live address at which you can receive messages. The name that you provide here will show up in attributions for your code submissions.

$ git config --global user.name &quot;Your Name&quot;
$ git config --global user.email &quot;you@example.com&quot;

Run repo init to bring down the latest version of Repo with all its most recent bug fixes. You must specify a URL for the manifest, which specifies where the various repositories included in the Android source will be placed within your working directory.

$ repo init -u https://android.googlesource.com/platform/manifest

To check out a branch other than &quot;master&quot;, specify it with -b. For a list of branches, see Source Code Tags and Builds.

$ repo init -u https://android.googlesource.com/platform/manifest -b android-4.0.1_r1

$ repo init -u git://aosp.tuna.tsinghua.edu.cn/android/platform/manifest -b android-4.0.1_r1
</code></pre><h1 id="下载-源码"><a href="#下载-源码" class="headerlink" title="下载 源码"></a>下载 源码</h1><h2 id="方法一，使用每月更新的初始化包"><a href="#方法一，使用每月更新的初始化包" class="headerlink" title="方法一，使用每月更新的初始化包"></a>方法一，使用每月更新的初始化包</h2><p>由于首次同步需要下载 24GB 数据，过程中任何网络故障都可能造成同步失败，我们强烈建议您使用初始化包进行初始化。</p>
<p>下载 <a href="https://mirrors.tuna.tsinghua.edu.cn/aosp-monthly/aosp-latest.tar，下载完成后记得根据" target="_blank" rel="external">https://mirrors.tuna.tsinghua.edu.cn/aosp-monthly/aosp-latest.tar，下载完成后记得根据</a> checksum.txt 的内容校验一下。</p>
<p>由于所有代码都是从隐藏的 .repo 目录中 checkout 出来的，所以我们只保留了 .repo 目录，下载后解压 再 repo sync 一遍即可得到完整的目录。</p>
<p>使用方法如下:</p>
<pre><code>wget https://mirrors.tuna.tsinghua.edu.cn/aosp-monthly/aosp-latest.tar # 下载初始化包
tar xf aosp-latest.tar
cd AOSP   
# 解压得到的 AOSP 工程目录
# 这时 ls 的话什么也看不到，因为只有一个隐藏的 .repo 目录
repo sync
# 正常同步一遍即可得到完整目录
# 或 repo sync -l 仅checkout代码
</code></pre><p>此后，每次只需运行 repo sync 即可保持同步。 我们强烈建议您保持每天同步，并尽量选择凌晨等低峰时间</p>
<h2 id="方法二，传统初始化方法"><a href="#方法二，传统初始化方法" class="headerlink" title="方法二，传统初始化方法"></a>方法二，传统初始化方法</h2><p>建立工作目录:</p>
<pre><code>mkdir WORKING_DIRECTORY
cd WORKING_DIRECTORY
</code></pre><p>初始化仓库:</p>
<pre><code>repo init -u https://aosp.tuna.tsinghua.edu.cn/platform/manifest
</code></pre><p>如果提示无法连接到 gerrit.googlesource.com，可以编辑 ~/bin/repo，把 REPO_URL 一行替换成下面的：<br>    REPO_URL = ‘<a href="https://gerrit-google.tuna.tsinghua.edu.cn/git-repo" target="_blank" rel="external">https://gerrit-google.tuna.tsinghua.edu.cn/git-repo</a>‘</p>
<p>如果需要某个特定的 Android 版本(列表)：</p>
<pre><code>repo init -u https://aosp.tuna.tsinghua.edu.cn/platform/manifest -b android-4.0.1_r1
</code></pre><p>同步源码树（以后只需执行这条命令来同步）：</p>
<pre><code>repo sync
</code></pre><h1 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h1><h2 id="建立次级镜像"><a href="#建立次级镜像" class="headerlink" title="建立次级镜像"></a>建立次级镜像</h2><p>由于 AOSP 镜像需求量巨大，且 Git 服务占资源较多，TUNA 服务器因 AOSP 产生的负载已经占主要部分。 如果你是团队用户，我们强烈建议你通过 TUNA 建立次级镜像，再分享给团队内其他用户，减轻 TUNA 服务器压力。 建立 AOSP 镜像需要占用约 80G 磁盘。</p>
<p>具体步骤为:</p>
<p>下载 repo 工具和建立工作目录（略）</p>
<p>初始化:</p>
<pre><code>repo init -u https://aosp.tuna.tsinghua.edu.cn/mirror/manifest --mirror
</code></pre><p>同步源码树:</p>
<pre><code>repo sync
</code></pre><p>同步完成后，运行 git daemon –verbose –export-all –base-path=WORKING_DIR WORKING_DIR (WORKING_DIR为代码树所在目录) 。</p>
<p>此后，其他用户使用 git://ip.to.mirror/ 作为镜像即可。</p>
<h2 id="替换已有的-AOSP-源代码的-remote"><a href="#替换已有的-AOSP-源代码的-remote" class="headerlink" title="替换已有的 AOSP 源代码的 remote"></a>替换已有的 AOSP 源代码的 remote</h2><p>如果你之前已经通过某种途径获得了 AOSP 的源码(或者你只是 init 这一步完成后)， 你希望以后通过 TUNA 同步 AOSP 部分的代码，只需要将 .repo/manifest.xml 把其中的 aosp 这个 remote 的 fetch 从 <a href="https://android.googlesource.com" target="_blank" rel="external">https://android.googlesource.com</a> 改为 <a href="https://aosp.tuna.tsinghua.edu.cn/。" target="_blank" rel="external">https://aosp.tuna.tsinghua.edu.cn/。</a></p>
<pre><code>&lt;manifest&gt;

   &lt;remote  name=&quot;aosp&quot;
-           fetch=&quot;https://android.googlesource.com&quot;
+           fetch=&quot;https://aosp.tuna.tsinghua.edu.cn&quot;
            review=&quot;android-review.googlesource.com&quot; /&gt;

   &lt;remote  name=&quot;github&quot;
</code></pre><p>同时，修改 .repo/manifests.git/config，将</p>
<pre><code>url = https://android.googlesource.com/platform/manifest
</code></pre><p>更改为</p>
<pre><code>url = https://aosp.tuna.tsinghua.edu.cn/platform/manifest
</code></pre><p>这个方法也可以用来在同步 Cyanogenmod 代码的时候从 TUNA 同步部分代码</p>
<h1 id="Build"><a href="#Build" class="headerlink" title="Build"></a>Build</h1><p>Clean up To ensure the newly installed binaries are properly taken into account after being extracted, delete the existing output of any previous build using:</p>
<pre><code>$ make clobber

报错

Error: could not find jdk tools.jar at /System/Library/Frameworks/JavaVM.framework/Versions/Current/Commands/../lib/tools.jar, please check if your JDK was installed correctly.  Stop.

解决办法：参考关于完整Android源码的阅读在~/.bash_profile文件中指定ANDROID_JAVA_HOME为JDK路径即可。

export ANDROID_JAVA_HOME=${JAVA_HOME}
</code></pre><p>Set up environment</p>
<pre><code>$ source build/envsetup.sh
</code></pre><p>Choose a target</p>
<pre><code>$ lunch aosp_arm-eng
</code></pre><p>Buildtype     Use<br>user     limited access; suited for production<br>userdebug     like “user” but with root access and debuggability; preferred for debugging<br>eng     development configuration with additional debugging tools<br>可选的有aosp_arm-eng、 aosp_arm64-eng、aosp_mips-eng、aosp_mips64-eng、aosp_x86-eng……</p>
<p>Build the code</p>
<pre><code>$ make -jN

N为数字，一般为cpu线程数1到2倍。我的本本是mbp2015年中，使用$ make -j8，很多warning，不管即可，用了一个多小时，最后输出结果#### make completed successfully (01:06:05 (hh:mm:ss)) ####
</code></pre><p>Emulate an Android Device</p>
<pre><code>$ emulator
</code></pre><h1 id="源码版本信息查看"><a href="#源码版本信息查看" class="headerlink" title="源码版本信息查看"></a>源码版本信息查看</h1><p>地址 <a href="https://source.android.com/source/build-numbers.html" target="_blank" rel="external">https://source.android.com/source/build-numbers.html</a></p>
<table>
<thead>
<tr>
<th>Build</th>
<th style="text-align:center">Branch</th>
<th style="text-align:right">Version</th>
<th style="text-align:right">Supported</th>
<th style="text-align:right">devices</th>
</tr>
</thead>
<tbody>
<tr>
<td>NRD90U</td>
<td style="text-align:center">android-7.0.0_r6</td>
<td style="text-align:right">Nougat</td>
<td style="text-align:right">Nexus</td>
<td style="text-align:right">6P</td>
</tr>
<tr>
<td>NRD90T</td>
<td style="text-align:center">android-7.0.0_r5</td>
<td style="text-align:right">Nougat</td>
<td style="text-align:right">Nexus</td>
<td style="text-align:right">6P</td>
</tr>
<tr>
<td>NRD90S</td>
<td style="text-align:center">android-7.0.0_r4</td>
<td style="text-align:right">Nougat</td>
<td style="text-align:right">Nexus</td>
<td style="text-align:right">5X</td>
</tr>
<tr>
<td>NRD90R</td>
<td style="text-align:center">android-7.0.0_r5</td>
<td style="text-align:right">Nougat</td>
<td style="text-align:right">Nexus</td>
<td style="text-align:right">5X</td>
</tr>
<tr>
<td>NRD90M</td>
<td style="text-align:center">android-7.0.0_r2</td>
<td style="text-align:right">Nougat</td>
<td style="text-align:right">Nexus</td>
<td style="text-align:right">5X</td>
</tr>
<tr>
<td>MTC20K</td>
<td style="text-align:center">android-7.0.0_r1</td>
<td style="text-align:right">Nougat</td>
<td style="text-align:right">Nexus</td>
<td style="text-align:right">5X</td>
</tr>
<tr>
<td>MTC20K</td>
<td style="text-align:center">android-6.0.1_r67</td>
<td style="text-align:right">Marshmallow</td>
<td style="text-align:right">Nexus</td>
<td style="text-align:right">5X</td>
</tr>
</tbody>
</table>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2016/10/04/Mac 下载 Android 源码及编译/">Mac 下载 Android 源码及编译</a></p>
        <p><span>文章作者:</span><a href="/" title="访问 以梦为马 的个人博客">以梦为马</a></p>
        <p><span>发布时间:</span>2016年10月04日 - 20时38分</p>
        <p><span>最后更新:</span>2016年10月12日 - 00时01分</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2016/10/04/Mac 下载 Android 源码及编译/" title="Mac 下载 Android 源码及编译">https://liyang-github.github.io/2016/10/04/Mac 下载 Android 源码及编译/</a>
            <span class="copy-path" data-clipboard-text="原文: https://liyang-github.github.io/2016/10/04/Mac 下载 Android 源码及编译/　　作者: 以梦为马" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script src="/js/clipboard.min.js"></script>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="中国大陆 (CC BY-NC-SA 3.0 CN)" target = "_blank">"署名-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



  
</article>

    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Jdk-版本要求"><span class="toc-number">1.</span> <span class="toc-text">Jdk 版本要求</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Mac-OS-build-environment"><span class="toc-number">2.</span> <span class="toc-text">Mac OS build environment</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#创建区分大小写的镜像（Creating-a-case-sensitive-disk-image）"><span class="toc-number">2.1.</span> <span class="toc-text">创建区分大小写的镜像（Creating a case-sensitive disk image）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#方法一，使用命令创建"><span class="toc-number">2.1.1.</span> <span class="toc-text">方法一，使用命令创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#方法二，使用磁盘工具创建"><span class="toc-number">2.1.2.</span> <span class="toc-text">方法二，使用磁盘工具创建</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装-JDK-和-SDK-下载安装包安装即可，略"><span class="toc-number">2.2.</span> <span class="toc-text">安装 JDK 和 SDK (下载安装包安装即可，略)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Installing-required-packages"><span class="toc-number">2.3.</span> <span class="toc-text">Installing required packages</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Install-MacPorts-from-macports-org-直接下载MacPorts-xxx-pkg文件安装即可-xxx为版本号"><span class="toc-number">2.3.1.</span> <span class="toc-text">Install MacPorts from macports.org(直接下载MacPorts_xxx.pkg文件安装即可(xxx为版本号))</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Get-make-git-and-GPG-packages-from-MacPorts"><span class="toc-number">2.3.2.</span> <span class="toc-text">Get make, git, and GPG packages from MacPorts:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#下载-repo-工具"><span class="toc-number">2.4.</span> <span class="toc-text">下载 repo 工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#初始化repo"><span class="toc-number">2.5.</span> <span class="toc-text">初始化repo</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#下载-源码"><span class="toc-number">3.</span> <span class="toc-text">下载 源码</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#方法一，使用每月更新的初始化包"><span class="toc-number">3.1.</span> <span class="toc-text">方法一，使用每月更新的初始化包</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#方法二，传统初始化方法"><span class="toc-number">3.2.</span> <span class="toc-text">方法二，传统初始化方法</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#TODO"><span class="toc-number">4.</span> <span class="toc-text">TODO</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#建立次级镜像"><span class="toc-number">4.1.</span> <span class="toc-text">建立次级镜像</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#替换已有的-AOSP-源代码的-remote"><span class="toc-number">4.2.</span> <span class="toc-text">替换已有的 AOSP 源代码的 remote</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Build"><span class="toc-number">5.</span> <span class="toc-text">Build</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#源码版本信息查看"><span class="toc-number">6.</span> <span class="toc-text">源码版本信息查看</span></a></li></ol>
</div>
<input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script>
    var valueHide = "隐藏目录";
    var valueShow = "显示目录";

    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }
    $("#tocButton").click(function() {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
        }
    })
    if ($(".toc").length < 1) {
        $("#toc, #tocButton").hide();
    }
</script>





<div class="bdsharebuttonbox">
	<a href="#" class="fx fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
	<a href="#" class="fx fa-weixin bds_weixin" data-cmd="weixin" title="分享到微信"></a>
	<a href="#" class="fx fa-qq bds_sqq" data-cmd="sqq" title="分享到QQ好友"></a>
	<a href="#" class="fx fa-facebook-official bds_fbook" data-cmd="fbook" title="分享到Facebook"></a>
	<a href="#" class="fx fa-twitter bds_twi" data-cmd="twi" title="分享到Twitter"></a>
	<a href="#" class="fx fa-linkedin bds_linkedin" data-cmd="linkedin" title="分享到linkedin"></a>
	<a href="#" class="fx fa-files-o bds_copy" data-cmd="copy" title="分享到复制网址"></a>
</div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>




    
      <div class="duoshuo" id="comments">
    <!-- 多说评论框 start -->
    <div class="ds-thread" data-thread-key="2016/10/04/Mac 下载 Android 源码及编译/" data-title="Mac 下载 Android 源码及编译" data-url="https://liyang-github.github.io/2016/10/04/Mac 下载 Android 源码及编译/"></div>
    <!-- 多说评论框 end -->
    <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:"null"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = '/js/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
    </script>
    <!-- 多说公共JS代码 end -->
</div>

    



    <div class="scroll" id="post-nav-button">
        
            <a href="/" title="回到主页"><i class="fa fa-home"></i></a>
        
        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>
        
            <a href="/" title="回到主页"><i class="fa fa-home"></i></a>
        
    </div>
    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2016/10/04/Mac 下载 Android 源码及编译/">Mac 下载 Android 源码及编译</a></li></ul>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
    <script>
        $(".post-list").addClass("toc-article");
        $(".post-list-item a").attr("target","_blank");
        $("#post-nav-button > a:nth-child(2)").click(function() {
            $(".fa-bars, .fa-times").toggle();
            $(".post-list").toggle(300);
            if ($(".toc").length > 0) {
                $("#toc, #tocButton").toggle(200, function() {
                    if ($(".switch-area").is(":visible")) {
                        $("#tocButton").attr("value", valueHide);
                        }
                    })
            }
            else {
            }
        })
    </script>



    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2016 以梦为马
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/luuman/hexo-theme-spfk" target="_blank">spfk</a> by luuman
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >海贼到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var backgroundnum = 24;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(

            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


    <script type="text/javascript">
      window.onload = function(){
        document.getElementById("search").onclick = function(){
            console.log("search")
            search();
        }
      }
      function search(){
        (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
        (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
        e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
        })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

        _st('install','A1Pz-LKMXbrzcFg2FWi6','2.0.0');
      }
    </script>

  </div>
</body>
</html>